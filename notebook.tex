
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Homework 3 and 4}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Assignment Sheets 3 \& 4}\label{assignment-sheets-3-4}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k}{using} \PY{n}{Pkg}
        \PY{n}{Pkg}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{y}\PY{l+s}{P}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{)} \PY{c}{\PYZsh{} adds a plotting package}
        \PY{n}{Pkg}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{S}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{F}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{Pkg}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{Pkg}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{S}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{s}\PY{l+s}{B}\PY{l+s}{a}\PY{l+s}{s}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{k}{using} \PY{n}{StatsBase}
        \PY{k}{using} \PY{n}{PyPlot}
        \PY{k}{using} \PY{n}{Random}
        \PY{k}{using} \PY{n}{SpecialFunctions}
        \PY{k}{using} \PY{n}{DelimitedFiles}
        \PY{k}{using} \PY{n}{Statistics}
        \PY{k}{using} \PY{n}{Distributions}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\textcolor{ansi-green-intense}{\textbf{  Updating}} registry at `\textasciitilde{}/.julia/registries/General`
\textcolor{ansi-green-intense}{\textbf{  Updating}} git-repo `https://github.com/JuliaRegistries/General.git`
[1mFetching: [========================================>]  100.0 \%.0 \% [=========>                               ]  21.1 \%]  42.1 \%]  43.3 \%==========================>              ]  64.4 \%]  85.3 \%\textcolor{ansi-green-intense}{\textbf{ Resolving}} package versions{\ldots}
\textcolor{ansi-green-intense}{\textbf{ Installed}} DualNumbers ─ v0.6.1
\textcolor{ansi-green-intense}{\textbf{ Installed}} StatsBase ─── v0.26.0
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Project.toml`
 \textcolor{ansi-black-intense}{ [fa6b7ba4]}\textcolor{ansi-yellow-intense}{ ↑ DualNumbers v0.6.0 ⇒ v0.6.1}
 \textcolor{ansi-black-intense}{ [2913bbd2]}\textcolor{ansi-yellow-intense}{ ↑ StatsBase v0.25.0 ⇒ v0.26.0}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Manifest.toml`
 \textcolor{ansi-black-intense}{ [fa6b7ba4]}\textcolor{ansi-yellow-intense}{ ↑ DualNumbers v0.6.0 ⇒ v0.6.1}
 \textcolor{ansi-black-intense}{ [2913bbd2]}\textcolor{ansi-yellow-intense}{ ↑ StatsBase v0.25.0 ⇒ v0.26.0}
\textcolor{ansi-green-intense}{\textbf{ Resolving}} package versions{\ldots}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Project.toml`
\textcolor{ansi-black-intense}{ [no changes]}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Manifest.toml`
\textcolor{ansi-black-intense}{ [no changes]}
\textcolor{ansi-green-intense}{\textbf{ Resolving}} package versions{\ldots}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Project.toml`
\textcolor{ansi-black-intense}{ [no changes]}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Manifest.toml`
\textcolor{ansi-black-intense}{ [no changes]}
\textcolor{ansi-green-intense}{\textbf{ Resolving}} package versions{\ldots}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Project.toml`
\textcolor{ansi-black-intense}{ [no changes]}
\textcolor{ansi-green-intense}{\textbf{  Updating}} `\textasciitilde{}/.julia/environments/v1.0/Manifest.toml`
\textcolor{ansi-black-intense}{ [no changes]}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: Recompiling stale cache file /home/rcascorbi/.julia/compiled/v1.0/StatsBase/EZjIG.ji for StatsBase [2913bbd2-ae8a-5f71-8c99-4fb6c76f3a91]
└ @ Base loading.jl:1184
┌ Info: Recompiling stale cache file /home/rcascorbi/.julia/compiled/v1.0/Distributions/xILW0.ji for Distributions [31c24e10-a181-5473-b8eb-7969acd0382f]
└ @ Base loading.jl:1184

    \end{Verbatim}

    \subsection{Q 3.1 (a)}\label{q-3.1-a}

The following code imports the financial data, cleans it and plots the
histogram of initial digits.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c}{\PYZsh{}Import the financial data and clean it}
        \PY{n}{Fin}\PY{o}{=}\PY{n}{readdlm}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{l}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{.}\PY{l+s}{c}\PY{l+s}{s}\PY{l+s}{v}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s+sc}{\PYZsq{},\PYZsq{}}\PY{p}{)}
        \PY{n}{NAcount}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{i} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{length}\PY{p}{(}\PY{n}{Fin}\PY{p}{[}\PY{o}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
            \PY{k}{if} \PY{n}{Fin}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{==}\PY{l+s}{\PYZdq{}}\PY{l+s}{n}\PY{l+s}{/}\PY{l+s}{a}\PY{l+s}{\PYZdq{}}
                \PY{n}{NAcount}\PY{o}{=}\PY{n}{NAcount}\PY{o}{+}\PY{l+m+mi}{1}
            \PY{k}{end}
        \PY{k}{end}
        \PY{n}{size}\PY{p}{(}\PY{n}{Fin}\PY{p}{)}
        
        
        \PY{k}{for} \PY{n}{i} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{p}{(}\PY{n}{size}\PY{p}{(}\PY{n}{Fin}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{NAcount}\PY{p}{)}
            \PY{k}{if} \PY{n}{Fin}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{n}\PY{l+s}{/}\PY{l+s}{a}\PY{l+s}{\PYZdq{}}
                \PY{n}{Fin}\PY{o}{=}\PY{n}{Fin}\PY{p}{[}\PY{l+m+mi}{1}\PY{o}{:}\PY{n}{size}\PY{p}{(}\PY{n}{Fin}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{.!=} \PY{n}{i}\PY{p}{,}\PY{o}{:} \PY{p}{]}
            \PY{k}{end}
        \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c}{\PYZsh{}Create a sample and extract the first digits of each element}
        \PY{n}{sampleSize}\PY{o}{=}\PY{l+m+mi}{90}
        \PY{n}{samp}\PY{o}{=}\PY{n}{sample}\PY{p}{(}\PY{n}{Fin}\PY{p}{[}\PY{o}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{sampleSize}\PY{p}{)}
        \PY{n}{samp} \PY{o}{=} \PY{p}{[}\PY{n}{d}\PY{p}{[}\PY{k}{end}\PY{p}{]} \PY{k}{for} \PY{n}{d} \PY{k+kp}{in} \PY{n}{digits}\PY{o}{.}\PY{p}{(}\PY{k+kt}{Int}\PY{o}{.}\PY{p}{(}\PY{n}{floor}\PY{o}{.}\PY{p}{(}\PY{n}{samp}\PY{o}{.*}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{]} \PY{c}{\PYZsh{}first digits}
        
        \PY{c}{\PYZsh{}Plot the histogram and the theoretical distribution according to Benford\PYZsq{}s law}
        \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{hist}\PY{p}{]}\PY{p}{(}\PY{n}{samp}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{k+kc}{true}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{plot}\PY{p}{]}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{9}\PY{p}{,} \PY{n}{log}\PY{o}{.}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{1} \PY{o}{.+} \PY{l+m+mi}{1} \PY{o}{./}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{B}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{d}\PY{l+s}{\PYZsq{}}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{l}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{z}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{9}\PY{l+s}{0}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{I}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_4_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:} PyObject <matplotlib.legend.Legend object at 0x7f5088f935c0>
\end{Verbatim}
            
    \subsubsection{(b)}\label{b}

The following code computes the p-values of Chi-squared tests with
Null-hypotheses according to Benford's law and a uniform distribution of
digits.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{function} \PY{n}{getPValues}\PY{p}{(}\PY{n}{sample}\PY{p}{)}
            \PY{n}{digitRange}\PY{o}{=}\PY{n}{collect}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{9}\PY{p}{)}
            \PY{n}{HisArray}\PY{o}{=}\PY{n}{fit}\PY{p}{(}\PY{n}{Histogram}\PY{p}{,} \PY{n}{sample}\PY{p}{,} \PY{n}{nbins}\PY{o}{=}\PY{l+m+mi}{9}\PY{p}{)}\PY{o}{.}\PY{n}{weights}
            \PY{n}{HisArray}\PY{o}{=}\PY{n}{HisArray}\PY{o}{./}\PY{n}{sum}\PY{p}{(}\PY{n}{HisArray}\PY{p}{)}
            \PY{n}{uniform}\PY{o}{=}\PY{n}{ones}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{)} \PY{o}{./}\PY{l+m+mi}{9}
            \PY{n}{benford}\PY{o}{=}\PY{n}{log}\PY{o}{.}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{1} \PY{o}{.+} \PY{l+m+mi}{1} \PY{o}{./}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}
            \PY{n}{ChiUni}\PY{o}{=}\PY{n}{length}\PY{p}{(}\PY{n}{sample}\PY{p}{)}\PY{o}{*}\PY{n}{sum}\PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{HisArray} \PY{o}{.\PYZhy{}} \PY{n}{uniform}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{./}\PY{p}{(}\PY{n}{uniform}\PY{p}{)}\PY{p}{)}
            \PY{n}{ChiBenford}\PY{o}{=}\PY{n}{length}\PY{p}{(}\PY{n}{sample}\PY{p}{)}\PY{o}{*}\PY{n}{sum}\PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{HisArray} \PY{o}{.\PYZhy{}} \PY{n}{benford}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{./}\PY{p}{(}\PY{n}{benford}\PY{p}{)}\PY{p}{)}
            \PY{n}{pUni}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{cdf}\PY{p}{(}\PY{n}{Chisq}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,} \PY{n}{ChiUni}\PY{p}{)}
            \PY{n}{pBenford}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{cdf}\PY{p}{(}\PY{n}{Chisq}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,}\PY{n}{ChiBenford}\PY{p}{)}
            \PY{k}{return} \PY{n}{pUni}\PY{p}{,} \PY{n}{pBenford}
        \PY{k}{end}
        
        
        
        \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{\PYZhy{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{m}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{z}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{9}\PY{l+s}{0}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{getPValues}\PY{p}{(}\PY{n}{samp}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{\PYZhy{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{B}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{d}\PY{l+s}{\PYZsq{}}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{z}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{9}\PY{l+s}{0}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{getPValues}\PY{p}{(}\PY{n}{samp}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The p-value for the uniform distribution  and a sample size of 90 is 9.046710491844578e-8      The p-value for Benford's distribution and a sample size of 90 is 0.8366795534095098
    \end{Verbatim}

    Using a sample size of n=90, the Chi-squared test clearly shows that the
uniform distribution has to be rejected, while Benford's distribution
should not be rejected with a p-value way above 5\%.

\subsubsection{(c)}\label{c}

Repeat the calculations with a sample size of n=900.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{samp2}\PY{o}{=}\PY{n}{sample}\PY{p}{(}\PY{n}{Fin}\PY{p}{[}\PY{o}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{900}\PY{p}{)}
         \PY{n}{samp2} \PY{o}{=} \PY{p}{[}\PY{n}{d}\PY{p}{[}\PY{k}{end}\PY{p}{]} \PY{k}{for} \PY{n}{d} \PY{k+kp}{in} \PY{n}{digits}\PY{o}{.}\PY{p}{(}\PY{k+kt}{Int}\PY{o}{.}\PY{p}{(}\PY{n}{floor}\PY{o}{.}\PY{p}{(}\PY{n}{samp2}\PY{o}{.*}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{]} \PY{c}{\PYZsh{}first digits}
         \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{\PYZhy{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{m}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{z}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{9}\PY{l+s}{0}\PY{l+s}{0}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{getPValues}\PY{p}{(}\PY{n}{samp2}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{\PYZhy{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{B}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{d}\PY{l+s}{\PYZsq{}}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{z}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{9}\PY{l+s}{0}\PY{l+s}{0}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{getPValues}\PY{p}{(}\PY{n}{samp2}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The p-value for the uniform distribution  and a sample size of 900 is 0.0      The p-value for Benford's distribution and a sample size of 900 is 8.134205243259807e-6
    \end{Verbatim}

    As was to be expected, the p-value for the uniform distribution has
decreased even more, in this case below the machine accuracy. The
p-value for Benford's law has also decreased below 0.01. The reason for
this is that The Chi-squared test is too accurate to take into account
expected fluctuations around Benford's law in a sample size of 900.

    \subsection{Q 3.2}\label{q-3.2}

The question asks whether or not the school is 'underperforming', which
can be answered by a one-sided test the null-hypothesis being that the
school performs average or above, i.e. that the underlying distribution
has an average of \textbf{75 or above}.

The following code produces the p-value for this test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{sMES}\PY{o}{=}\PY{l+m+mi}{7}\PY{o}{/}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}
        
        \PY{n}{pValue}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{cdf}\PY{p}{(}\PY{n}{Normal}\PY{p}{(}\PY{l+m+mi}{72}\PY{p}{,} \PY{n}{sMES}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{75}\PY{p}{)}
        \PY{c}{\PYZsh{}print(invlogcdf(Normal(72,sMES), log(0.95)))}
        \PY{n}{print}\PY{p}{(}\PY{n}{pValue}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.009452920389165897
    \end{Verbatim}

    The p-value is both below 5\% and just below 1\%. We can therefore
reject the Null-hypothesis with both 5\% and 1\% accuracy.

    \section{Q 3.3}\label{q-3.3}

The expression

\[\frac{1}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}}\]

can be split up into to factors \$\frac{1}{\sqrt{v  \pi}}
\frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}}
\$ and \$ \frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}}\$

The left factor can be expressed as follows

\[\frac{1}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} = \frac{1}{\sqrt{v  \pi}} \exp{\ln{\frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}}}}= \frac{1}{\sqrt{v  \pi}} \exp{ \left[ \ln{\Gamma{\left( \frac{v+1}{2} \right)}}-\ln{\Gamma{\left( \frac{v}{2} \right)}}\right]}\]

We can use Sterling's approximation to get the leading orders of the
Gamma function for large arguments:

\[ \ln{\Gamma{n}} \approx n\ln{n}-n . \]

Thus up to order \(n\) in the exponent we obtain

\[ \frac{1}{\sqrt{v  \pi}} \exp{\left[ \frac{v+1}{2} \ln{\left(\frac{v+1}{2}\right)} - \frac{v+1}{2} - \left(\frac{v}{2} \ln{\left(\frac{v}{2}\right)} -\frac{v}{2}  \right) \right]}  \]

Breaking up all logarithms into sums yields

\[  \frac{1}{\sqrt{v  \pi}} \exp{ \left[ \frac{v}{2} \left( \ln{v} + \ln{\left( 1+ \frac{1}{v} \right)} -\ln{2} \right) + \frac{1}{2}  \left( \ln{v} + \ln{\left( 1+ \frac{1}{v} \right)} -\ln{2} \right) -\frac{v}{2}\ln{v} +\frac{v}{2} +\frac{v}{2}\ln{2} -\frac{v}{2}-\frac{1}{2}  \right]} \]

\[= \frac{1}{\sqrt{v  \pi}} \exp{ \left[ \frac{v}{2} \ln{\left( 1+ \frac{1}{v} \right)} + \frac{1}{2}  \left( \ln{v} + \ln{\left( 1+ \frac{1}{v} \right)} -\ln{2} \right)-\frac{1}{2}  \right]} \]

Taylor expand the logarithms of the form \(\ln{1+\frac{1}{v}}\)
retaining all terms in the exponent of order \(1\) and above, yielding:

\[ \frac{1}{\sqrt{v  \pi}} \exp{ \left[ \frac{1}{2}  + \frac{1}{2}  \left( \ln{v}  -\ln{2} \right)-\frac{1}{2} + \mathcal{O}(\ln{\frac{v}{2}})  \right]}
= \frac{1}{\sqrt{v  \pi}} \exp{ \left[ \frac{1}{2}  \left( \ln{v}  -\ln{2} \right) \right]} 
= \frac{1}{\sqrt{v  \pi}} \exp{ \left[ \frac{1}{2}  \ln{\frac{v}{2}} \right]}  
=\frac{1}{\sqrt{v  \pi}} \sqrt{\frac{v}{2}}
=\frac{1}{\sqrt{2 \pi}}
\]

No we take the limit of the second factor of the t-distribution,
rewriting

\[\frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}}= \exp{ \ln {\left[ \left( 1+\frac{t^2}{v} \right) ^{-\frac{v+1}{2}} \right]}}= \exp{ \left[-\frac{v+1}{2} \ln { \left( 1+\frac{t^2}{v} \right) } \right]} \]

Taylor expanding the logarithms up to order 1 in the exponent yields

\[ \exp{ \left[ -\frac{v+1}{2} \left( \frac{t^2}{v} + \mathcal{O}(\frac{1}{v^2}) \right) \right]}=\exp{ \left[ -\frac{t^2}{2} + \mathcal{O}(\frac{1}{v}) \right]}\]

In the limit of large \(v\) this simply yields

\[ \exp \left[ -\frac{t^2}{2} \right] \]

Reuniting the two factors we obtain the limiting distribution, which is
a Gaussian distribution with zero mean and unit variance:

\[\lim_{v \rightarrow \infty} \frac{1}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}} = \frac{1}{\sqrt{2 \pi}} e^{ -\frac{t^2}{2}}\]

\subsubsection{First order correction to the
variance}\label{first-order-correction-to-the-variance}

In order to obtain the first-order correction to the limit of the
t-distribution variance for large n, we have to derive a general
expression for the variance of the t-distribution.

First, calculate the mean of the t-distribution

\[E[t]= \int_{-\infty}^{\infty} t \frac{1}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}} dt\]

Since \$ \frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}}\$ is an
even function of \(t\) and \(t\) is odd, the integral evaluates to zero,
thus

\[ E[t]=0.\]

The variance is thus simply the second moment of the t-distribution,
namely

\[ Var[t]= \int_{-\infty}^{\infty} t^2 \frac{1}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \frac{1}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}} dt.\]

Pulling all constants to the front and exploiting the fact that the
integral's \(t\)-dependence is symmetrical, we can rewrite it as

\[Var[t]= \frac{2}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \int_{0}^{\infty} \frac{t^2}{\left( 1+ \frac{t^{2}}{v} \right)^{(v+1)/2}} dt.\]

Now we perform a change of variables \(y=(1+\frac{t^2}{v})^{-1}\), such
that
\(dt=\frac{v}{2 y^2} \frac{1}{\sqrt{v \left( \frac{1}{y}-1 \right)}}dy\).
This way out integral becomes

\[ \frac{2}{\sqrt{v  \pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \int_{0}^{1} dy v \left(\frac{1}{y}-1 \right) y^{\frac{v+1}{2}} \frac{v}{2 y^2} \frac{1}{\sqrt{v \left( \frac{1}{y}-1 \right)}} \]

\[= \frac{v}{\sqrt{\pi}} \frac{\Gamma{\left( \frac{v+1}{2} \right)}}{\Gamma{\left( \frac{v}{2} \right)}} \int_{0}^{1} dy \left( 1-y \right)^\frac{1}{2} y^{\frac{v}{2}-2}\]

Exploiting the fact that \(\Gamma{(\frac{1}{2})}=\pi\) and that the
integral resembles a gamma distribution with normalisationf factor

\[\int_{0}^{1}  x^{p-1} (1-x)^{q-1} dx =\frac{\Gamma{(p)}\Gamma{(q)}}{\Gamma{(p+q)}} \]

with \(p=\frac{v}{2}-1\) and \(q=\frac{3}{2}\), we can evaluate the
integral to

\[ Var[t]=v \frac{\Gamma{(\frac{v}{2}-1)}\Gamma{(\frac{3}{2})}}{\Gamma{(\frac{1}{2})}\Gamma{(\frac{v}{2})}}=\frac{v}{v-2}.  \]

Finally, we can expand the expression of the variance of the
t-distribution for large v:

\[ Var[t]=\frac{v}{v-2}= \frac{1}{1-\frac{2}{v}} = 1+\frac{2}{v} +\mathcal{O}(v^{-2})\]

    \section{Q 4.1}\label{q-4.1}

    Suppose we draw a sample \(X_1, X_2, ..., X_n\) from a normal
distribution. The likelihood that one of tese \(X_i\) is drawn from a
normal distribution with mean \(μ\) and variance \(σ^2\) is

\[ \mathcal{L} \left( X_i  | \mathcal{N}(μ, σ) \right)=\frac{1}{\sqrt{2 \pi σ^2}} e^{-\frac{(X_i-μ)^2}{2σ^2}}  \]

Since all these \(X_i\) are independent of each other, the likelyhood
that they were all drawn from the same Normal distribution with mean
\(μ\) and variance \(σ^2\) is

\[ \mathcal{L} \left( X_1, X_2, ..., X_n  | \mathcal{N}(μ, σ) \right) \sim \prod_{i=1}^{n} \left[ \frac{1}{\sqrt{2 \pi σ^2}} e^{-\frac{(X_i-μ)^2}{2σ^2}} \right], \]

which can be normalised if needed.

The values of μ and σ that maximise the likelihood
\(\mathcal{L} \left( X_1, X_2, ..., X_n | \mathcal{N}(μ, σ) \right)\)
can be found by finding the maxima of the logarithm of this expression.

\[ \ln \mathcal{L}\left( X_1, X_2, ..., X_n  | \mathcal{N}(μ, σ) \right) = \ln \left( \prod_{i=1}^{n} \left[ \frac{1}{\sqrt{2 \pi σ^2}} e^{-\frac{(X_i-μ)^2}{2σ^2}} \right] \right) \]

\[
= \sum_{i=1}^{n} \ln \left( \frac{1}{\sqrt{2 \pi σ^2}} e^{-\frac{(X_i-μ)^2}{2σ^2}}  \right) 
=\sum_{i=1}^{n} \left[ \ln  e^{-\frac{(X_i-μ)^2}{2σ^2}} -\ln \left( \sqrt{2 \pi σ^2} \right) \right]
= \sum_{i=1}^{n} \left[   -\frac{(X_i-μ)^2}{2σ^2} -\ln(\sqrt{2 \pi}σ)  \right]
\]

No we differentiate this expression partially, once with respect to μ
and once with respect to σ. We set the result equal zero to determine
the values of μ and σ that maximise the likelihood. Let's start out with
μ:

\[
\frac{\partial}{\partial μ} \ln \mathcal{L}\left( X_1, X_2, ..., X_n  | \mathcal{N}(μ, σ) \right)= \sum_{i=1}^{n} \frac{X_i-μ}{σ^2}=0
\]

This yields

\[ \hat{μ}=\frac{1}{n} \sum_{i=1}^{n} X_i= \bar{X},\]

which is equal to the mean of the sample.

The variance maximising the likelihood can be determined in a very
similar way:

\[\frac{\partial}{\partial σ} \ln \mathcal{L}\left( X_1, X_2, ..., X_n  | \mathcal{N}(μ, σ) \right)=  \sum_{i=1}^{n} \left[\frac{(X_i-μ)^2}{σ^3}  -\frac{1}{σ} \right]=0\]

Thus

\[
\hat{σ}^2=\frac{1}{n} \sum_{i=1}^{n} (X_i-μ)^2
\]

Inserting \(\hat{μ}=\bar{X}\) for \(μ\) yields

\[
\hat{σ}^2=\frac{1}{n} \sum_{i=1}^{n} (X_i-\bar{X})^2=\bar{σ}^2,
\]

which is the sample variance. As we have shown in class, the sample
variance is not an unbiased estimator of the actual underlying
\emph{population variance} σ\^{}2 of the distribution that the sample
was actually drawn from. In fact, it can be shown that

\[ E\left[ \hat{σ}^2 \right]= σ^2- E\left[ ( \bar{X} - μ )^2  \right] = \left(1-\frac{1}{n} \right) σ^2 < σ^2. \]

Thus, we can define an \emph{unbiased sample variance}

\[σ_{unbiased}^2=\frac{1}{n-1} \sum_{i=1}^{n} (X_i-\bar{X})^2, \]

which based on the above argument \emph{can} be shown to be an unbiased
estimator of the population variance.

    \section{Q 4.2}\label{q-4.2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c}{\PYZsh{} Function to calculate posterior distribution given ranges of discritised μ, variance, a prior and a set of datapoints.}
        \PY{k}{function} \PY{n}{getPosterior}\PY{p}{(}\PY{n}{Range1}\PY{p}{,} \PY{n}{Range2}\PY{p}{,} \PY{n}{Prior}\PY{p}{,}\PY{n}{data}\PY{p}{)}
            \PY{n}{Likelihood}\PY{o}{=}\PY{n}{ones}\PY{p}{(}\PY{n}{length}\PY{p}{(}\PY{n}{Range1}\PY{p}{)}\PY{p}{,} \PY{n}{length}\PY{p}{(}\PY{n}{Range2}\PY{p}{)}\PY{p}{)}
            \PY{k}{for} \PY{n}{k} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{length}\PY{p}{(}\PY{n}{data}\PY{p}{)}
                \PY{k}{for} \PY{n}{i} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{length}\PY{p}{(}\PY{n}{Range1}\PY{p}{)}
                    \PY{k}{for} \PY{n}{j} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{length}\PY{p}{(}\PY{n}{Range2}\PY{p}{)}
                        \PY{n}{Likelihood}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{o}{=}\PY{n}{Likelihood}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n+nb}{pi}\PY{o}{*}\PY{n}{Range2}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{Range1}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{o}{\PYZca{}}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{Range2}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                    \PY{k}{end}
                \PY{k}{end}
            \PY{k}{end}
            \PY{k}{return} \PY{p}{(}\PY{n}{Likelihood} \PY{o}{.*}\PY{n}{Prior}\PY{p}{)}\PY{o}{./}\PY{p}{(}\PY{n}{sum}\PY{p}{(}\PY{n}{Likelihood} \PY{o}{.*}\PY{n}{Prior}\PY{p}{)}\PY{p}{)}
        \PY{k}{end}
            
        \PY{c}{\PYZsh{}function to compute mean and variance of data points.}
        \PY{k}{function} \PY{n}{getMuVar}\PY{p}{(}\PY{n}{dat}\PY{p}{)}
            \PY{n}{mu}\PY{o}{=}\PY{n}{mean}\PY{p}{(}\PY{n}{dat}\PY{p}{)}
            \PY{n}{sig}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{n}{length}\PY{p}{(}\PY{n}{dat}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{dat} \PY{o}{.\PYZhy{}}\PY{n}{mu}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{l+m+mi}{2} \PY{p}{)}
            \PY{k}{return} \PY{n}{mu}\PY{p}{,} \PY{n}{sig}
        \PY{k}{end}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} getMuVar (generic function with 1 method)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c}{\PYZsh{}Set values for mu and sigma}
        \PY{n}{μ}\PY{o}{=}\PY{l+m+mi}{2}
        \PY{n}{σ}\PY{o}{=}\PY{l+m+mi}{1}
        \PY{n}{variance}\PY{o}{=}\PY{n}{σ}\PY{o}{\PYZca{}}\PY{l+m+mi}{2}
        \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{5}
        \PY{n}{data}\PY{o}{=}\PY{n}{rand}\PY{p}{(}\PY{n}{Normal}\PY{p}{(}\PY{n}{μ}\PY{p}{,} \PY{n}{σ}\PY{p}{)}\PY{p}{,} \PY{n}{n}\PY{p}{)}
        \PY{n}{muRange}\PY{o}{=}\PY{n}{collect}\PY{p}{(}\PY{l+m+mi}{0}\PY{o}{:}\PY{l+m+mf}{0.01}\PY{o}{:}\PY{l+m+mi}{4}\PY{p}{)}
        \PY{n}{varRange}\PY{o}{=}\PY{n}{collect}\PY{p}{(}\PY{l+m+mf}{0.01}\PY{o}{:}\PY{l+m+mf}{0.01}\PY{o}{:}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n}{Prior}\PY{o}{=}\PY{n}{ones}\PY{p}{(}\PY{n}{length}\PY{p}{(}\PY{n}{muRange}\PY{p}{)}\PY{p}{,}\PY{n}{length}\PY{p}{(}\PY{n}{varRange}\PY{p}{)}\PY{p}{)}\PY{o}{./}\PY{p}{(}\PY{n}{length}\PY{p}{(}\PY{n}{muRange}\PY{p}{)}\PY{o}{*}\PY{n}{length}\PY{p}{(}\PY{n}{varRange}\PY{p}{)}\PY{p}{)}
        \PY{n}{Posterior}\PY{o}{=}\PY{n}{getPosterior}\PY{p}{(}\PY{n}{muRange}\PY{p}{,} \PY{n}{varRange}\PY{p}{,} \PY{n}{Prior}\PY{p}{,} \PY{n}{data}\PY{p}{)}
        \PY{n}{print}\PY{p}{(}\PY{n}{getMuVar}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{)}
        \PY{n}{print}\PY{p}{(}\PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{V}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{)}
        
        \PY{n}{muMarginal}\PY{o}{=}\PY{n}{sum}\PY{p}{(}\PY{n}{Posterior}\PY{p}{,} \PY{n}{dims}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{[}\PY{o}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{varMarginal}\PY{o}{=}\PY{n}{sum}\PY{p}{(}\PY{n}{Posterior}\PY{p}{,} \PY{n}{dims}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{:}\PY{p}{]}
        \PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(2.1552497283342062, 0.3451290176635098)2.17 Variance 0.35000000000000003
    \end{Verbatim}

    The following plot shows the posterior distribution of the mean and the
variance, based on a uniform prior, discritised into steps of 0.01 for
both mean and variance. The horizontal and vertical lines pick out
particular values of the mean and the variance, namely the maximum of
the 2D posterior distribution, the maxima of its respective marginal
distributions, as well as the values for the mean and variance that were
initially set to create the simulation data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
        \PY{c}{\PYZsh{}theme(:sand)}
        \PY{c}{\PYZsh{}heatmap(sigmaRange, muRange,Posterior)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{pcolormesh}\PY{p}{]}\PY{p}{(}\PY{n}{varRange}\PY{p}{,} \PY{n}{muRange}\PY{p}{,} \PY{n}{Posterior}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{f}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{n}\PY{l+s}{o}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{2}\PY{l+s}{D}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axhline}\PY{p}{]}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{varMarginal}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axhline}\PY{p}{]}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{muMarginal}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{variance}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axhline}\PY{p}{]}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{n}{μ}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{μ}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{σ}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
        \PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{V}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
        \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{μ}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} PyObject <matplotlib.legend.Legend object at 0x7f5088d1ec18>
\end{Verbatim}
            
    The following bit of code compares the position of the maximum of the
posterior distribution to \(\hat{μ}\) and \(\hat{σ}\) that maximise the
likelihood of our data points, as derived in Q 4.1. As expected, the
values coincide.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{μ}\PY{l+s}{ }\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{,}\PY{l+s}{ }\PY{l+s}{w}\PY{l+s}{h}\PY{l+s}{i}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{c}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{y}\PY{l+s}{ }\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{getMuVar}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{.}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{S}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{i}\PY{l+s}{l}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{l}\PY{l+s}{y}\PY{l+s}{,}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{,}\PY{l+s}{ }\PY{l+s}{w}\PY{l+s}{h}\PY{l+s}{i}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{c}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{getMuVar}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{.}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The value of μ maximising the posterior distribution is 2.17, while the theoretically computed value is 2.1552497283342062. Similarly, the value of the variance maximising the posterior distribution is 0.35000000000000003, while the theoreticall computed value is 0.3451290176635098.
    \end{Verbatim}

    The following plots show the marginals of the 2D posterior distribution.
It can be seen that the value of μ that maximises the 2D posterior
distribution is the same as the value of μ that maximises the marginal
distribution, which is the same as the theoretical \(\hat{μ}\).

However, this is not the case for the variance. The value maximising the
marginal distribution tends to be larger than that maximising the 2D
posterior. However, it can be see that the \textbf{unbiased sample
variance} \(σ_{unbiased}^2\) calculated in Q 4.1 maximises the marginal
posterior distribution.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
         \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{plot}\PY{p}{]}\PY{p}{(}\PY{n}{muRange}\PY{p}{,} \PY{n}{muMarginal}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{muMarginal}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{u}\PY{l+s}{m}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{b}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{u}\PY{l+s}{m}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{2}\PY{l+s}{D}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{μ}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         
         
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{μ}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
         
         \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
         \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{plot}\PY{p}{]}\PY{p}{(}\PY{n}{varRange}\PY{p}{,} \PY{n}{varMarginal}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{varMarginal}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{u}\PY{l+s}{m}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{variance}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{findmax}\PY{p}{(}\PY{n}{Posterior}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{M}\PY{l+s}{a}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{u}\PY{l+s}{m}\PY{l+s}{ }\PY{l+s}{o}\PY{l+s}{f}\PY{l+s}{ }\PY{l+s}{2}\PY{l+s}{D}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{b}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{/}\PY{l+s}{S}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{p}{[}\PY{o}{:}\PY{n}{axvline}\PY{p}{]}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{getMuVar}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{n}{length}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{length}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{U}\PY{l+s}{n}\PY{l+s}{b}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{s}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{m}\PY{l+s}{p}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{V}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} PyObject <matplotlib.legend.Legend object at 0x7f50841c99b0>
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
